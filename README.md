# CS-ISTA
2024BUPT课堂实验课六 基于压缩感知(CS)和迭代收缩阈值算法（ISTA）的医学图像重建实验
# README.md
老师做的参考PPT简直是依托，要交的时候突然发现还要绘图，人才
## 一、实验目的
利用压缩感知算法对医学图像进行重建，理解压缩感知理论在图像重建中的应用原理，掌握基于压缩感知的图像重建算法的实现过程。

## 二、实验原理
传统医学图像数据采集过程较为缓慢。压缩感知理论指出，对于具有稀疏性或可压缩性的信号，可以通过远低于奈奎斯特采样率的方式进行采样，并利用信号的稀疏特性从少量的测量数据中准确地重建出原始信号。

## 三、实验材料和工具
- **软件工具**：MATLAB、Python（NumPy, SciPy, PyTorch等）、或其他科学计算软件。
- **硬件要求**：一台性能良好的计算机，足够的内存和处理能力来运行模拟和重建算法。

## 四、实验方法与步骤

1. **生成模拟物体模型（10分）**
   - 选择一个合适的图像作为原始图像，可以是从研学课上获取的大脑磁共振图像，也可以是Shepp-Logan phantom。

2. **模拟磁共振成像k空间数据获取（10分）**
   - 对原始图像进行二维离散傅里叶变换（2D-FFT），得到其在k空间的完整数据。

3. **设计稀疏采样模式（15分）**
   - 设计一种稀疏采样模式，例如采用随机欠采样、均匀欠采样或高斯欠采样方式。确定至少三种欠采样率（如25%、50%、75%等），即从完整的k空间数据中随机选取一定比例的数据点，其余数据点置零，得到欠采样的k空间数据。

4. **对图像进行稀疏变换（15分）**
   - 选择一种稀疏变换方法，如小波变换。对原始图像进行变换，得到其在变换域的系数表示。在变换域中，观察是否大部分系数接近零，如是，则该变换为稀疏变换。

5. **图像重建（30分）**
   - 选择一种压缩感知图像重建算法，以迭代收缩阈值算法（ISTA）为例：
     - 第一步，初始化重建图像（可以是全零图像或其他简单的初始估计），对k空间填零后进行傅里叶逆变换得到初始图像。
     - 在每次迭代中：计算当前重建图像的稀疏变换系数。
     - 根据数据一致性约束和稀疏性先验，更新重建图像的估计值，通过求解一个优化问题来调整系数，使得重建图像的k空间数据与欠采样的k空间数据尽可能匹配，同时保持系数的稀疏性。
     - 检查迭代终止条件，如达到最大迭代次数或重建图像的变化小于一定阈值。
     - 如果使用cvxpy库实现基于凸优化的重建算法（如BP），则需要根据压缩感知的数学模型构建凸优化问题，并使用合适的求解器求解。

6. **结果评估（20分）**
   - 计算重建图像与原始图像之间的峰值信噪比（PSNR）和结构相似性指数（SSIM）等指标，以定量评估重建图像的质量。
   - 可视化不同稀疏采样率下原始图像、欠采样后的k空间数据、重建图像及其对应的频谱图等，直观地比较和分析重建效果。
   - 绘制重建质量指标随欠采样率变化的曲线

## 五、实验总结
- 分析不同稀疏采样率下重建图像的质量
- 绘制重建质量指标随欠采样率变化的曲线，解释曲线的变化趋势，讨论压缩感知技术的适用性。
- 根据实验结果，讨论压缩感知在医学图像重建中的优势和局限性，并提出可能的改进方向。

## 六、参考文献
- Lustig, M., Donoho, D., & Pauly, J. M. (2007). Sparse MRI: The application of compressed sensing for rapid MR imaging. *Magnetic Resonance in Medicine*, 58(6), 1182-1195. DOI:10.1002/mrm.21391
